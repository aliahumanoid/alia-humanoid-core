<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alia Joint Controller</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <style>
        .status-container {
            max-height: calc(100vh - 10rem);
            overflow-y: auto;
        }

        /* Style for smart buttons with automatic execution active */
        .auto-execute-enabled button {
            border: 2px solid #f97316 !important;
                            /* Orange border */
            box-shadow: 0 0 5px rgba(249, 115, 22, 0.5) !important;
                            /* Orange shadow */
            position: relative;
        }

        .auto-execute-enabled button::after {
            content: "ðŸš€";
            position: absolute;
            top: -8px;
            right: -8px;
            font-size: 14px;
            background-color: #f97316;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(0.95);
                opacity: 0.7;
            }

            50% {
                transform: scale(1.05);
                opacity: 1;
            }

            100% {
                transform: scale(0.95);
                opacity: 0.7;
            }
        }
    </style>
</head>

<body class="bg-gray-100">

    <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>

    <nav class="bg-blue-600 p-4 text-white">
        <div class="flex items-center px-4">
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Alia Logo" class="h-16 mr-4">
            <h1 class="text-2xl font-bold">Joint Controller</h1>
        </div>
    </nav>

    <div class="flex h-screen overflow-hidden">
        <!-- Left fixed column for Status Messages -->
        <div class="w-1/4 p-4 bg-white shadow-md overflow-y-auto relative" style="height: calc(100vh - 4rem);">
            <h2 class="text-xl font-semibold mb-4">Status Messages</h2>
            <div class="relative">
                <ul id="statusMessages" class="list-disc pl-5 text-xs status-container"></ul>
                <!-- Scroll button will be added dynamically here -->
            </div>
        </div>

        <!-- Right scrollable column for controls and charts -->
        <div class="w-3/4 overflow-y-auto p-4" style="height: calc(100vh - 4rem);">
            <!-- Joint and DOF Selection -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">Joint Selection</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="jointSelect" class="block text-sm font-medium text-gray-700">Select
                            Joint:</label>
                        <select id="jointSelect"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                            <option value="KNEE_LEFT" selected>Left Knee</option>
                            <option value="KNEE_RIGHT">Right Knee</option>
                            <option value="ANKLE_LEFT">Left Ankle</option>
                            <option value="ANKLE_RIGHT">Right Ankle</option>
                            <option value="HIP_LEFT">Left Hip</option>
                            <option value="HIP_RIGHT">Right Hip</option>
                        </select>
                    </div>
                    <div>
                        <label for="serialPortSelect" class="block text-sm font-medium text-gray-700">Serial Port:</label>
                        <div class="mt-1 flex items-center space-x-2">
                            <select id="serialPortSelect"
                                class="flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                <option value="">Select port</option>
                            </select>
                            <button id="refreshSerialPorts" type="button"
                                class="p-2 rounded-md border border-gray-300 text-gray-600 hover:bg-gray-100"
                                title="Refresh port list">
                                <i class="fas fa-sync"></i>
                            </button>
                        </div>
                        <p id="serialPortHint" class="text-xs text-gray-500 mt-1"></p>
                    </div>
                </div>
            </div>

            <div class="flex flex-wrap -mx-4">
                <!-- Control buttons column -->
                <div class="w-full lg:w-1/3 px-4 mb-8">
                    <!-- Auto Mapping -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Auto Mapping</h2>
                        <p class="text-sm text-gray-600 mb-4">This function activates advanced automatic mapping
                            for the selected joint.</p>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="sendCommand('start-auto-mapping')"
                                class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-robot mr-2"></i>START_AUTO_MAPPING
                            </button>
                            <button onclick="sendCommand('stop-auto-mapping')"
                                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-stop mr-2"></i>STOP_AUTO_MAPPING
                            </button>
                        </div>
                        <div class="mt-4 text-sm text-gray-600">
                            <p>Offset recalculation is now available in specific controls for each DOF.</p>
                        </div>
                    </div>

                    <!-- Simultaneous Multi-DOF Command -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4 text-indigo-700">
                            <i class="fas fa-arrows-alt mr-2"></i>Simultaneous Multi-DOF Command
                        </h2>
                        <p class="text-sm text-gray-600 mb-4">
                            Control multiple degrees of freedom simultaneously with optional synchronization
                        </p>

                        <!-- Angle inputs for each DOF -->
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="multiDofAngle0" class="block text-sm font-medium text-gray-700">Angle DOF 0
                                    (degrees):</label>
                                <input id="multiDofAngle0" type="number" value="0" step="0.1"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </div>
                            <div>
                                <label for="multiDofAngle1" class="block text-sm font-medium text-gray-700">Angle DOF 1
                                    (degrees):</label>
                                <input id="multiDofAngle1" type="number" value="0" step="0.1"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </div>
                        </div>

                        <!-- Smart quick buttons based on mapping -->
                        <div class="mb-4" id="smartQuickButtons">
                            <!-- Buttons will be generated dynamically by JavaScript -->
                        </div>

                        <!-- Toggle for automatic execution -->
                        <div class="mb-4 flex items-center justify-between">
                            <label for="autoExecuteToggle" class="text-sm font-medium text-gray-700 flex items-center">
                                <i class="fas fa-bolt mr-2 text-yellow-500"></i>Automatic execution:
                            </label>
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="autoExecuteToggle" class="sr-only peer">
                                <div
                                    class="relative w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-indigo-600">
                                </div>
                                <span class="ml-2 text-sm font-medium text-gray-700">Off/On</span>
                            </label>
                        </div>

                        <!-- Button to regenerate smart buttons -->
                        <div class="mb-4 text-center">
                            <button onclick="generateSmartQuickButtons()"
                                class="bg-indigo-500 hover:bg-indigo-600 text-white text-xs py-1 px-3 rounded transition-colors">
                                <i class="fas fa-sync-alt mr-1"></i>Update Smart Buttons
                            </button>
                        </div>

                        <!-- Advanced parameters -->
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="multiDofMask" class="block text-sm font-medium text-gray-700">DOF Mask:</label>
                                <select id="multiDofMask"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                                    <option value="1">Only DOF 0 (1)</option>
                                    <option value="2">Only DOF 1 (2)</option>
                                    <option value="3" selected>DOF 0 + 1 (3)</option>
                                    <option value="4">Only DOF 2 (4)</option>
                                    <option value="5">DOF 0 + 2 (5)</option>
                                    <option value="6">DOF 1 + 2 (6)</option>
                                    <option value="7">All DOFs (7)</option>
                                </select>
                            </div>
                            <div>
                                <label for="multiDofSync"
                                    class="block text-sm font-medium text-gray-700">Synchronization:</label>
                                <select id="multiDofSync"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                                    <option value="0">No synchronization</option>
                                    <option value="1" selected>Synchronize by duration</option>
                                    <option value="2">Synchronize by speed</option>
                                </select>
                            </div>
                        </div>

                        <!-- Movement parameters -->
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="multiDofSpeed" class="block text-sm font-medium text-gray-700">Speed
                                    (rad/s):</label>
                                <input id="multiDofSpeed" type="number" value="0.5" step="0.1" min="0.1" max="2.0"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </div>
                            <div>
                                <label for="multiDofAccel" class="block text-sm font-medium text-gray-700">Accel. Time
                                    (s):</label>
                                <input id="multiDofAccel" type="number" value="0.2" step="0.1" min="0.1" max="5.0"
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                            </div>
                        </div>

                        <div class="mb-4">
                            <label for="multiDofPath" class="block text-sm font-medium text-gray-700">Path Type
:</label>
                            <select id="multiDofPath"
                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                                <option value="0">PATH_LINEAR</option>
                                <option value="1" selected>PATH_TRIG</option>
                                <option value="2">PATH_QUAD</option>
                            </select>
                        </div>

                        <!-- Control buttons -->
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="sendMultiDofMove()"
                                class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                                <i class="fas fa-play mr-2"></i>Execute Multi-DOF Movement
                            </button>
                            <button onclick="sendCommand('stop-move')"
                                class="w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg transition-colors">
                                <i class="fas fa-stop mr-2"></i>Stop Movement
                            </button>
                        </div>

                        <!-- Generated command (debug) -->
                        <div class="mt-4">
                            <label for="multiDofCommandPreview" class="block text-sm font-medium text-gray-700">Command Generated:</label>
                            <textarea id="multiDofCommandPreview" rows="2" readonly
                                class="mt-1 block w-full rounded-md border-gray-300 bg-gray-50 text-xs font-mono shadow-sm"></textarea>
                        </div>
                    </div>

                    <!-- PID Control -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">PID Control</h2>

                        <!-- DOF tab selectors -->
                        <div class="flex mb-4 space-x-2 pid-tab-selectors">
                            <button id="pidTabSelector0" onclick="showPidTab(0)"
                                class="pid-tab-selector flex-1 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                DOF 0
                            </button>
                            <button id="pidTabSelector1" onclick="showPidTab(1)"
                                class="pid-tab-selector flex-1 bg-gray-300 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded">
                                DOF 1
                            </button>
                            <button id="pidTabSelector2" onclick="showPidTab(2)"
                                class="pid-tab-selector flex-1 bg-gray-300 hover:bg-gray-400 text-white font-bold py-2 px-4 rounded">
                                DOF 2
                            </button>
                        </div>

                        <!-- DOF 0 tab contents -->
                        <div id="pidTabDof0" class="pid-tab">
                            <h3 class="text-lg font-semibold mb-2">DOF 0 - Motor Agonist (1)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="agonistPidDof0Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="agonistPidDof0Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof0Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="agonistPidDof0Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof0Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="agonistPidDof0Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof0Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="agonistPidDof0Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(0, 1)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded mb-4">
                                <i class="fas fa-save mr-2"></i>Update Agonist PID
                            </button>

                            <h3 class="text-lg font-semibold mb-2">DOF 0 - Motor Antagonist (2)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="antagonistPidDof0Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="antagonistPidDof0Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof0Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="antagonistPidDof0Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof0Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="antagonistPidDof0Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof0Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="antagonistPidDof0Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(0, 2)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-save mr-2"></i>Update Antagonist PID
                            </button>

                            <div class="mt-6 border-t pt-4">
                                <h3 class="text-lg font-semibold mb-3">DOF 0 - Outer Loop Cascade</h3>
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                                    <div>
                                        <label for="outerPidDof0Kp"
                                            class="block text-sm font-medium text-gray-700">Kp:</label>
                                        <input id="outerPidDof0Kp" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof0Ki"
                                            class="block text-sm font-medium text-gray-700">Ki:</label>
                                        <input id="outerPidDof0Ki" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof0Kd"
                                            class="block text-sm font-medium text-gray-700">Kd:</label>
                                        <input id="outerPidDof0Kd" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof0Stiffness"
                                            class="block text-sm font-medium text-gray-700">Stiffness (Â°):</label>
                                        <input id="outerPidDof0Stiffness" type="number" placeholder="Loading..." step="0.1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof0Cascade"
                                            class="block text-sm font-medium text-gray-700">Cascade Influence (0-1):</label>
                                        <input id="outerPidDof0Cascade" type="number" placeholder="Loading..." step="0.05" min="0" max="1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    <button onclick="requestOuterPidForDof(0)"
                                        class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-download mr-2"></i>Load Outer PID
                                    </button>
                                    <button onclick="updateOuterPidForDof(0)"
                                        class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-save mr-2"></i>Update Outer PID
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- DOF 1 tab contents -->
                        <div id="pidTabDof1" class="pid-tab" style="display: none;">
                            <h3 class="text-lg font-semibold mb-2">DOF 1 - Motor Agonist (1)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="agonistPidDof1Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="agonistPidDof1Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof1Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="agonistPidDof1Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof1Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="agonistPidDof1Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof1Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="agonistPidDof1Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(1, 1)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded mb-4">
                                <i class="fas fa-save mr-2"></i>Update Agonist PID
                            </button>

                            <h3 class="text-lg font-semibold mb-2">DOF 1 - Motor Antagonist (2)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="antagonistPidDof1Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="antagonistPidDof1Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof1Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="antagonistPidDof1Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof1Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="antagonistPidDof1Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof1Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="antagonistPidDof1Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(1, 2)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-save mr-2"></i>Update Antagonist PID
                            </button>

                            <div class="mt-6 border-t pt-4">
                                <h3 class="text-lg font-semibold mb-3">DOF 1 - Outer Loop Cascade</h3>
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                                    <div>
                                        <label for="outerPidDof1Kp"
                                            class="block text-sm font-medium text-gray-700">Kp:</label>
                                        <input id="outerPidDof1Kp" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof1Ki"
                                            class="block text-sm font-medium text-gray-700">Ki:</label>
                                        <input id="outerPidDof1Ki" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof1Kd"
                                            class="block text-sm font-medium text-gray-700">Kd:</label>
                                        <input id="outerPidDof1Kd" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof1Stiffness"
                                            class="block text-sm font-medium text-gray-700">Stiffness (Â°):</label>
                                        <input id="outerPidDof1Stiffness" type="number" placeholder="Loading..." step="0.1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof1Cascade"
                                            class="block text-sm font-medium text-gray-700">Cascade Influence (0-1):</label>
                                        <input id="outerPidDof1Cascade" type="number" placeholder="Loading..." step="0.05" min="0" max="1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    <button onclick="requestOuterPidForDof(1)"
                                        class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-download mr-2"></i>Load Outer PID
                                    </button>
                                    <button onclick="updateOuterPidForDof(1)"
                                        class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-save mr-2"></i>Update Outer PID
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- DOF 2 tab contents -->
                        <div id="pidTabDof2" class="pid-tab" style="display: none;">
                            <h3 class="text-lg font-semibold mb-2">DOF 2 - Motor Agonist (1)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="agonistPidDof2Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="agonistPidDof2Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof2Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="agonistPidDof2Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof2Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="agonistPidDof2Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="agonistPidDof2Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="agonistPidDof2Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(2, 1)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded mb-4">
                                <i class="fas fa-save mr-2"></i>Update Agonist PID
                            </button>

                            <h3 class="text-lg font-semibold mb-2">DOF 2 - Motor Antagonist (2)</h3>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div>
                                    <label for="antagonistPidDof2Kp"
                                        class="block text-sm font-medium text-gray-700">Kp:</label>
                                    <input id="antagonistPidDof2Kp" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof2Ki"
                                        class="block text-sm font-medium text-gray-700">Ki:</label>
                                    <input id="antagonistPidDof2Ki" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof2Kd"
                                        class="block text-sm font-medium text-gray-700">Kd:</label>
                                    <input id="antagonistPidDof2Kd" type="number" placeholder="Loading..." step="0.0001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                                <div>
                                    <label for="antagonistPidDof2Tau"
                                        class="block text-sm font-medium text-gray-700">Tau:</label>
                                    <input id="antagonistPidDof2Tau" type="number" placeholder="Loading..." step="0.001"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                </div>
                            </div>
                            <button onclick="updatePidForDofMotor(2, 2)"
                                class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-save mr-2"></i>Update Antagonist PID
                            </button>

                            <div class="mt-6 border-t pt-4">
                                <h3 class="text-lg font-semibold mb-3">DOF 2 - Outer Loop Cascade</h3>
                                <div class="grid grid-cols-1 md:grid-cols-5 gap-4 mb-4">
                                    <div>
                                        <label for="outerPidDof2Kp"
                                            class="block text-sm font-medium text-gray-700">Kp:</label>
                                        <input id="outerPidDof2Kp" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof2Ki"
                                            class="block text-sm font-medium text-gray-700">Ki:</label>
                                        <input id="outerPidDof2Ki" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof2Kd"
                                            class="block text-sm font-medium text-gray-700">Kd:</label>
                                        <input id="outerPidDof2Kd" type="number" placeholder="Loading..." step="0.01"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof2Stiffness"
                                            class="block text-sm font-medium text-gray-700">Stiffness (Â°):</label>
                                        <input id="outerPidDof2Stiffness" type="number" placeholder="Loading..." step="0.1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                    <div>
                                        <label for="outerPidDof2Cascade"
                                            class="block text-sm font-medium text-gray-700">Cascade Influence (0-1):</label>
                                        <input id="outerPidDof2Cascade" type="number" placeholder="Loading..." step="0.05" min="0" max="1"
                                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                    </div>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                                    <button onclick="requestOuterPidForDof(2)"
                                        class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-download mr-2"></i>Load Outer PID
                                    </button>
                                    <button onclick="updateOuterPidForDof(2)"
                                        class="w-full bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded">
                                        <i class="fas fa-save mr-2"></i>Update Outer PID
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Hidden PID inputs (kept for legacy socket.io compatibility) -->
                        <div style="display: none;">
                            <input id="kpInput" type="number">
                            <input id="kiInput" type="number">
                            <input id="kdInput" type="number">
                        </div>

                        <!-- Button to load all PIDs -->
                        <button onclick="loadAllPids()"
                            class="mt-4 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                            <i class="fas fa-download mr-2"></i>Load All PID Values
                        </button>
                        <button onclick="sendCommand('save-pid')"
                            class="mt-2 w-full bg-emerald-500 hover:bg-emerald-600 text-white font-bold py-2 px-4 rounded">
                            <i class="fas fa-save mr-2"></i>Save PID & Cascade to Flash
                        </button>
                    </div>

                    <!-- Utility Controls -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Utility Controls</h2>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="sendCommand('reset-errors')"
                                class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-exclamation-triangle mr-2"></i>Reset Errors
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Charts column -->
                <div class="w-full lg:w-2/3 px-4">
                    <!-- Specific visualization for each joint type -->
                    <div id="kneePanel" class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Knee Visualization</h2>

                        <!-- Encoder Test Controls -->
                        <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                            <h3 class="text-lg font-semibold mb-3">Real-Time Encoder Test</h3>
                            <div class="grid grid-cols-3 gap-4 items-end mb-3">
                                <div>
                                    <label for="kneeEncoderInterval"
                                        class="block text-sm font-medium text-gray-700">Interval (ms):</label>
                                    <select id="kneeEncoderInterval"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                        <option value="200">200ms</option>
                                        <option value="500" selected>500ms</option>
                                        <option value="1000">1000ms</option>
                                        <option value="2000">2000ms</option>
                                        <option value="5000">5000ms</option>
                                    </select>
                                </div>
                                <button onclick="startEncoderTest('KNEE')"
                                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-play mr-2"></i>Start Test
                                </button>
                                <button onclick="stopEncoderTest('KNEE')"
                                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-stop mr-2"></i>Stop Test
                                </button>
                            </div>
                            <!-- Encoder values display -->
                            <div id="kneeEncoderValues" class="text-sm text-gray-600 font-mono">
                                <div class="grid grid-cols-1 gap-1">
                                    <div>DOF 0 (Flexion-Extension): <span id="kneeEncoderDof0"
                                            class="font-bold text-blue-600">-- Â°</span></div>
                                </div>
                            </div>
                        </div>

                        <div style="height: 400px;">
                            <canvas id="kneeChart"></canvas>
                        </div>
                        <button onclick="resetTemporalChart(kneeChart, 'knee')"
                            class="mt-2 w-full text-xs bg-gray-400 hover:bg-gray-500 text-white py-1 px-2 rounded">
                            <i class="fas fa-redo mr-1"></i>Reset Chart
                        </button>
                        <div id="kneeDof0Buttons" class="mt-2 space-y-2"></div>
                    </div>

                    <div id="anklePanel" class="bg-white rounded-lg shadow-md p-6 mb-8" style="display: none;">
                        <h2 class="text-xl font-semibold mb-4">Ankle Visualization</h2>

                        <!-- Encoder Test Controls -->
                        <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                            <h3 class="text-lg font-semibold mb-3">Real-Time Encoder Test</h3>
                            <div class="grid grid-cols-3 gap-4 items-end mb-3">
                                <div>
                                    <label for="ankleEncoderInterval"
                                        class="block text-sm font-medium text-gray-700">Interval (ms):</label>
                                    <select id="ankleEncoderInterval"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                        <option value="200">200ms</option>
                                        <option value="500" selected>500ms</option>
                                        <option value="1000">1000ms</option>
                                        <option value="2000">2000ms</option>
                                        <option value="5000">5000ms</option>
                                    </select>
                                </div>
                                <button onclick="startEncoderTest('ANKLE')"
                                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-play mr-2"></i>Start Test
                                </button>
                                <button onclick="stopEncoderTest('ANKLE')"
                                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-stop mr-2"></i>Stop Test
                                </button>
                            </div>
                            <!-- Encoder values display -->
                            <div id="ankleEncoderValues" class="text-sm text-gray-600 font-mono">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>DOF 0 (Plantar-Dorsal): <span id="ankleEncoderDof0"
                                            class="font-bold text-blue-600">-- Â°</span></div>
                                    <div>DOF 1 (Inversion-Eversion): <span id="ankleEncoderDof1"
                                            class="font-bold text-green-600">-- Â°</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- Separate temporal charts for each DOF -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-2">DOF 0 - Plantar-Dorsal</h4>
                                <div style="height: 300px;">
                                    <canvas id="ankleDof0Chart"></canvas>
                                </div>
                                <button onclick="resetTemporalChart(ankleDof0Chart, 'ankle_dof0')"
                                    class="mt-2 w-full text-xs bg-gray-400 hover:bg-gray-500 text-white py-1 px-2 rounded">
                                    <i class="fas fa-redo mr-1"></i>Reset Chart
                                </button>
                                <div id="ankleDof0Buttons" class="mt-2 space-y-2"></div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-2">DOF 1 - Inversion-Eversion</h4>
                                <div style="height: 300px;">
                                    <canvas id="ankleDof1Chart"></canvas>
                                </div>
                                <button onclick="resetTemporalChart(ankleDof1Chart, 'ankle_dof1')"
                                    class="mt-2 w-full text-xs bg-gray-400 hover:bg-gray-500 text-white py-1 px-2 rounded">
                                    <i class="fas fa-redo mr-1"></i>Reset Chart
                                </button>
                                <div id="ankleDof1Buttons" class="mt-2 space-y-2"></div>
                            </div>
                        </div>
                    </div>

                    <div id="hipPanel" class="bg-white rounded-lg shadow-md p-6 mb-8" style="display: none;">
                        <h2 class="text-xl font-semibold mb-4">Hip Visualization</h2>

                        <!-- Encoder Test Controls -->
                        <div class="mb-4 p-4 bg-gray-50 rounded-lg">
                            <h3 class="text-lg font-semibold mb-3">Real-Time Encoder Test</h3>
                            <div class="grid grid-cols-3 gap-4 items-end mb-3">
                                <div>
                                    <label for="hipEncoderInterval"
                                        class="block text-sm font-medium text-gray-700">Interval (ms):</label>
                                    <select id="hipEncoderInterval"
                                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50">
                                        <option value="200">200ms</option>
                                        <option value="500" selected>500ms</option>
                                        <option value="1000">1000ms</option>
                                        <option value="2000">2000ms</option>
                                        <option value="5000">5000ms</option>
                                    </select>
                                </div>
                                <button onclick="startEncoderTest('HIP')"
                                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-play mr-2"></i>Start Test
                                </button>
                                <button onclick="stopEncoderTest('HIP')"
                                    class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                    <i class="fas fa-stop mr-2"></i>Stop Test
                                </button>
                            </div>
                            <!-- Encoder values display -->
                            <div id="hipEncoderValues" class="text-sm text-gray-600 font-mono">
                                <div class="grid grid-cols-2 gap-4">
                                    <div>DOF 0 (Flexion-Extension): <span id="hipEncoderDof0"
                                            class="font-bold text-blue-600">-- Â°</span></div>
                                    <div>DOF 1 (Abduction-Adduction): <span id="hipEncoderDof1"
                                            class="font-bold text-green-600">-- Â°</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- Separate temporal charts for each DOF -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-2">DOF 0 - Flexion-Extension</h4>
                                <div style="height: 300px;">
                                    <canvas id="hipDof0Chart"></canvas>
                                </div>
                                <button onclick="resetTemporalChart(hipDof0Chart, 'hip_dof0')"
                                    class="mt-2 w-full text-xs bg-gray-400 hover:bg-gray-500 text-white py-1 px-2 rounded">
                                    <i class="fas fa-redo mr-1"></i>Reset Chart
                                </button>
                                <div id="hipDof0Buttons" class="mt-2 space-y-2"></div>
                            </div>
                            <div>
                                <h4 class="text-sm font-medium text-gray-700 mb-2">DOF 1 - Abduction-Adduction</h4>
                                <div style="height: 300px;">
                                    <canvas id="hipDof1Chart"></canvas>
                                </div>
                                <button onclick="resetTemporalChart(hipDof1Chart, 'hip_dof1')"
                                    class="mt-2 w-full text-xs bg-gray-400 hover:bg-gray-500 text-white py-1 px-2 rounded">
                                    <i class="fas fa-redo mr-1"></i>Reset Chart
                                </button>
                                <div id="hipDof1Buttons" class="mt-2 space-y-2"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">DOF Mapping Charts</h2>
                        <div class="mb-4 flex flex-wrap gap-2">
                            <button onclick="refreshMappingDataForCurrentJoint()"
                                class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-sync mr-2"></i>Refresh Mapping Data
                            </button>
                            <button onclick="clearAllMappingCharts()"
                                class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-eraser mr-2"></i>Clear All Charts
                            </button>
                            <button onclick="listSavedMappingFiles()"
                                class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-list mr-2"></i>List Files
                            </button>
                            <button onclick="deleteSavedMappingData()"
                                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-trash mr-2"></i>Delete Current
                            </button>
                            <button onclick="exportInterpolationEquations($('#jointSelect').val())"
                                class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-download mr-2"></i>Export Equations
                            </button>
                        </div>
                        <div class="mb-4">
                            <span id="mappingDataInfo" class="text-sm text-gray-600">
                                No data loaded
                            </span>
                        </div>

                        <!-- Container for separate multi-DOF mapping charts -->
                        <div id="mappingChartsContainer">
                            <!-- Charts will be created dynamically here -->
                            <!-- Each DOF will have two charts: one for measured data and one for interpolated data -->
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Real-Time Measurements</h2>
                        <div style="height: 400px;">
                            <canvas id="realTimeChart"></canvas>
                        </div>
                        <div class="mt-4 flex space-x-4">
                            <button onclick="startMeasureOutput()"
                                class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-play mr-2"></i>Start Measure
                            </button>
                            <button onclick="stopMeasureOutput()"
                                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-stop mr-2"></i>Stop Measure
                            </button>
                            <button onclick="saveMeasurementData()"
                                class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-save mr-2"></i>Save Data
                            </button>
                        </div>
                    </div>

                    <!-- Movement Charts Multi-DOF -->
                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Movement Charts Multi-DOF</h2>
                        <div class="mb-4 flex flex-wrap gap-2">
                            <button id="getMovementDataBtn" onclick="requestMovementDataFromPico()"
                                class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-download mr-2"></i>Get Movement Data
                            </button>
                            <button onclick="clearAllMovementCharts()"
                                class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-eraser mr-2"></i>Clear All Charts
                            </button>
                        </div>

                        <!-- Container for multi-DOF movement charts -->
                        <div id="movementChartsMultiDofContainer">
                            <div class="text-center text-gray-500 py-8">
                                <i class="fas fa-chart-line text-4xl mb-4"></i>
                                <p>No multi-DOF movement data available</p>
                                <p class="text-sm">Charts will appear here when data is received from PICO</p>
                            </div>
                        </div>
                    </div>



                    <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                        <h2 class="text-xl font-semibold mb-4">Output Chart</h2>
                        <div style="height: 400px;">
                            <canvas id="outputChart"></canvas>
                        </div>
                        <div class="mt-4 flex space-x-4">
                            <button onclick="startMeasureOutput()"
                                class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-play mr-2"></i>Start Measure Output
                            </button>
                            <button onclick="stopMeasureOutput()"
                                class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                                <i class="fas fa-stop mr-2"></i>Stop Measure Output
                            </button>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

</body>

</html>
